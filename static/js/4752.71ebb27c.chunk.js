"use strict";(globalThis.webpackChunk_jbrowse_web=globalThis.webpackChunk_jbrowse_web||[]).push([[4752],{91392:(e,t,n)=>{n.d(t,{KM:()=>p,en:()=>f,kb:()=>y,se:()=>h});var r=n(7552),l=n(75785),a=n(68446),o=n(36422),s=n(99546),i=n(95095),c=n(48231),m=n(90257);function d(){return d=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},d.apply(null,arguments)}const u=(0,l.n9)()((()=>({vtext:{gridColumn:"1/2",gridRow:"1/2",pointerEvents:"none",userSelect:"none"},htext:{gridColumn:"2/2",gridRow:"2/2",pointerEvents:"none",userSelect:"none"}}))),p=(0,a.observer)((function({model:e}){const{viewWidth:t,borderY:n}=e,{classes:l}=u();return r.createElement("svg",{width:t,height:n,className:l.htext},r.createElement(h,{model:e}))})),h=(0,a.observer)((function({model:e}){const{viewWidth:t,borderX:n,borderY:l,hview:a,htextRotation:u,hticks:p}=e,{offsetPx:h,width:f,dynamicBlocks:y,bpPerPx:g}=a,E=y.contentBlocks,b=(0,m.rQ)(E,t,h),v=(0,c.A)(),w={...(0,o.getSnapshot)(a),width:f,staticBlocks:a.staticBlocks},k=p.map((e=>[e,(0,i.eB)({refName:e.refName,coord:e.base,self:w})?.offsetPx])).filter((e=>void 0!==e[1])).map((e=>[e[0],e[1]-h]));return r.createElement(r.Fragment,null,E.filter((e=>!b.has(e.key))).map((e=>{const t=e.offsetPx,n=Math.floor(t-a.offsetPx);return r.createElement("text",d({transform:`rotate(${u},${n},0)`,key:JSON.stringify(e),x:n,y:1,fontSize:11,dominantBaseline:"hanging",textAnchor:"end"},(0,s.getFillProps)(v.palette.text.primary)),e.refName)})),k.map((([e,t])=>t>0&&t<f?r.createElement("line",d({key:`line-${JSON.stringify(e)}`,x1:t,x2:t,y1:0,y2:"major"===e.type?6:4,strokeWidth:1},(0,s.getFillProps)(v.palette.text.primary))):null)),k.filter((e=>"major"===e[0].type)).map((([e,t])=>t>10&&t<f?r.createElement("text",d({x:t-7,y:0,transform:`rotate(${u},${t},0)`,key:`text-${JSON.stringify(e)}`,fontSize:11,dominantBaseline:"middle",textAnchor:"end"},(0,s.getFillProps)(v.palette.text.primary)),(0,s.getTickDisplayStr)(e.base+1,g)):null)),r.createElement("text",d({y:l-12,x:(t-n)/2,textAnchor:"middle",fontSize:11,dominantBaseline:"hanging"},(0,s.getFillProps)(v.palette.text.primary)),a.assemblyNames.join(",")))})),f=(0,a.observer)((function({model:e}){const{borderX:t,viewHeight:n}=e,{classes:l}=u();return r.createElement("svg",{className:l.vtext,width:t,height:n},r.createElement(y,{model:e}))})),y=(0,a.observer)((function({model:e}){const{viewHeight:t,borderX:n,borderY:l,vview:a,vtextRotation:u,vticks:p}=e,{offsetPx:h,width:f,dynamicBlocks:y,bpPerPx:g}=a,E=y.contentBlocks,b=(0,m.rQ)(E,t,h),v=(0,c.A)(),w={...(0,o.getSnapshot)(a),width:f,staticBlocks:a.staticBlocks},k=p.map((e=>[e,(0,i.eB)({refName:e.refName,coord:e.base,self:w})?.offsetPx])).filter((e=>void 0!==e[1])).map((e=>[e[0],e[1]-h]));return r.createElement(r.Fragment,null,E.filter((e=>!b.has(e.key))).map((e=>{const l=e.offsetPx,a=n,o=Math.floor(t-l+h);return r.createElement("text",d({transform:`rotate(${u},${a},${l})`,key:JSON.stringify(e),x:a,y:o,fontSize:11,textAnchor:"end"},(0,s.getFillProps)(v.palette.text.primary)),e.refName)})),k.map((([e,l])=>l>0?r.createElement("line",d({key:`line-${JSON.stringify(e)}`,y1:t-l,y2:t-l,x1:n,x2:n-("major"===e.type?6:4),strokeWidth:1},(0,s.getStrokeProps)(v.palette.grey[400]))):null)),k.filter((e=>"major"===e[0].type)).map((([e,l])=>l>10&&l<t?r.createElement("text",d({y:t-l-3,x:n-7,key:`text-${JSON.stringify(e)}`,textAnchor:"end",dominantBaseline:"hanging",fontSize:11},(0,s.getFillProps)(v.palette.text.primary)),(0,s.getTickDisplayStr)(e.base+1,g)):null)),r.createElement("text",d({y:(t-l)/2,x:12,transform:`rotate(-90,12,${(t-l)/2})`,textAnchor:"middle",fontSize:11},(0,s.getFillProps)(v.palette.text.primary)),a.assemblyNames.join(",")))}))},14752:(e,t,n)=>{n.r(t),n.d(t,{default:()=>he});var r=n(7552),l=n(49823),a=n(68446),o=n(42489),s=n(75785),i=n(88994),c=n.n(i),m=n(48171),d=n(22679),u=n(56089),p=n(33371),h=n(33248),f=n(63896),y=n(67314),g=n(943),E=n(36715),b=n(5401),v=n(99546);function w({radioOption:e,assembly1:t,assembly2:n,fileLocation:r,bed1Location:l,bed2Location:a}){if(".paf"===e)return{type:"PAFAdapter",pafLocation:r,queryAssembly:t,targetAssembly:n};if(".out"===e)return{type:"MashMapAdapter",outLocation:r,queryAssembly:t,targetAssembly:n};if(".delta"===e)return{type:"DeltaAdapter",deltaLocation:r,queryAssembly:t,targetAssembly:n};if(".chain"===e)return{type:"ChainAdapter",chainLocation:r,queryAssembly:t,targetAssembly:n};if(".anchors"===e)return{type:"MCScanAnchorsAdapter",mcscanAnchorsLocation:r,bed1Location:l,bed2Location:a,assemblyNames:[t,n]};if(".anchors.simple"===e)return{type:"MCScanSimpleAnchorsAdapter",mcscanSimpleAnchorsLocation:r,bed1Location:l,bed2Location:a,assemblyNames:[t,n]};throw new Error(`Unknown to detect type ${e} from filename (select radio button to clarify)`)}const k=(0,a.observer)((({assembly1:e,assembly2:t,setSessionTrackData:n})=>{const[a,o]=(0,r.useState)(),[s,i]=(0,r.useState)(),[c,m]=(0,r.useState)(),[d,f]=(0,r.useState)(""),[b,v]=(0,r.useState)(),k=(A=c)?A.uri||A.localPath||A.name:void 0;var A;const x=d||(k?function(e){const t=e.split(".").pop();return t?`.${t}`:""}(function(e){return e.endsWith(".gz")?e.slice(0,-3):e}(k)):"");return(0,r.useEffect)((()=>{try{if(c){const r=k?k.split("#")[0].split("?")[0].split("/").pop():"MyTrack",l=`${r}-${Date.now()}`;v(void 0),n({trackId:l,name:r,assemblyNames:[t,e],type:"SyntenyTrack",adapter:w({radioOption:x,assembly1:e,assembly2:t,fileLocation:c,bed1Location:s,bed2Location:a})})}}catch(e){console.error(e),v(e)}}),[k,e,t,s,a,c,x,n]),r.createElement(g.A,{style:{padding:12}},b?r.createElement(l.ErrorMessage,{error:b}):null,r.createElement(E.A,{style:{textAlign:"center"}},"Add a .paf, .out (MashMap), .delta (Mummer), .chain, .anchors or .anchors.simple (MCScan) file to view in the dotplot. These file types can also be gzipped. The first assembly should be the query sequence (e.g. left column of the PAF) and the second assembly should be the target sequence (e.g. right column of the PAF)"),r.createElement(u.A,{value:x,onChange:e=>f(e.target.value)},r.createElement(y.Ay,{container:!0,justifyContent:"center"},r.createElement(y.Ay,{item:!0},r.createElement(p.A,{value:".paf",control:r.createElement(h.A,null),label:".paf"})),r.createElement(y.Ay,{item:!0},r.createElement(p.A,{value:".out",control:r.createElement(h.A,null),label:".out"})),r.createElement(y.Ay,{item:!0},r.createElement(p.A,{value:".delta",control:r.createElement(h.A,null),label:".delta"})),r.createElement(y.Ay,{item:!0},r.createElement(p.A,{value:".chain",control:r.createElement(h.A,null),label:".chain"})),r.createElement(y.Ay,{item:!0},r.createElement(p.A,{value:".anchors",control:r.createElement(h.A,null),label:".anchors"})),r.createElement(y.Ay,{item:!0},r.createElement(p.A,{value:".anchors.simple",control:r.createElement(h.A,null),label:".anchors.simple"})))),r.createElement(y.Ay,{container:!0,justifyContent:"center"},r.createElement(y.Ay,{item:!0},".anchors"===d||".anchors.simple"===d?r.createElement("div",null,r.createElement("div",{style:{margin:20}},"Open the ",d," and .bed files for both genome assemblies from the MCScan (Python version) pipeline"," ",r.createElement("a",{href:"https://github.com/tanghaibao/jcvi/wiki/MCscan-(Python-version)"},"(more info)")),r.createElement("div",{style:{display:"flex"}},r.createElement("div",null,r.createElement(l.FileSelector,{name:".anchors file",description:"",location:c,setLocation:e=>m(e)})),r.createElement("div",null,r.createElement(l.FileSelector,{name:"genome 1 .bed (left column of anchors file)",description:"",location:s,setLocation:e=>i(e)})),r.createElement("div",null,r.createElement(l.FileSelector,{name:"genome 2 .bed (right column of anchors file)",description:"",location:a,setLocation:e=>o(e)})))):r.createElement(l.FileSelector,{name:d?d+" location":"",description:"",location:c,setLocation:e=>m(e)}))))}));var A=n(98360),x=n(29629),S=n(91468),C=n(68584),P=n(90542);const M=(0,a.observer)((({model:e,assembly1:t,assembly2:n,setShowTrackId:a})=>{const o=(0,v.getSession)(e),{tracks:s,sessionTracks:i}=o,c=[...s,...i||[]].filter((e=>function(e,t,n){const r=(0,C.readConfObject)(e,"assemblyNames");return r.includes(t)&&r.includes(n)&&e.type.includes("Synteny")}(e,n,t))),m=c[0]?.trackId||"",[d,u]=(0,r.useState)(m);return(0,r.useEffect)((()=>{u(m)}),[m]),(0,r.useEffect)((()=>{a(d)}),[d,a]),r.createElement(g.A,{style:{padding:12}},r.createElement(E.A,{paragraph:!0},'Select a track from the select box below, the track will be shown when you hit "Launch".'),r.createElement(E.A,{paragraph:!0},"Note: there is a track selector ",r.createElement("i",null,"inside")," the DotplotView, which can turn on one or more SyntenyTracks (more than one can be displayed at once). Look for the track selector icon ",r.createElement(P.xU,null)),c.length?r.createElement(A.A,{value:d,onChange:e=>u(e.target.value)},c.map((e=>r.createElement(x.A,{key:e.trackId,value:e.trackId},(0,S.getTrackName)(e,o))))):r.createElement(l.ErrorMessage,{error:`No synteny tracks found for ${t},${n}`}))})),L=(0,s.n9)()((e=>({importFormContainer:{padding:e.spacing(4),margin:"0 auto"},assemblySelector:{width:"75%",margin:"0 auto"}})));function N({setSessionTrackData:e,setShowTrackId:t,sessionTrackData:n,assembly1:l,assembly2:a,model:o}){const[s,i]=(0,r.useState)("tracklist");return(0,r.useEffect)((()=>{"none"===s&&(e(void 0),t(void 0))}),[s,e,t]),r.createElement(r.Fragment,null,r.createElement(m.A,null,r.createElement(d.A,{id:"group-label"},"(Optional) Select or add a synteny track"),r.createElement(u.A,{row:!0,value:s,onChange:e=>i(e.target.value),"aria-labelledby":"group-label"},r.createElement(p.A,{value:"none",control:r.createElement(h.A,null),label:"None"}),r.createElement(p.A,{value:"tracklist",control:r.createElement(h.A,null),label:"Existing track"}),r.createElement(p.A,{value:"custom",control:r.createElement(h.A,null),label:"New track"}))),"custom"===s?r.createElement(k,{setSessionTrackData:e,sessionTrackData:n,assembly2:a,assembly1:l}):null,"tracklist"===s?r.createElement(M,{model:o,assembly1:l,assembly2:a,setShowTrackId:t}):null)}const B=(0,a.observer)((({model:e})=>{const{classes:t}=L(),n=(0,v.getSession)(e),{assemblyNames:a}=n,[s,i]=(0,r.useState)(a[0]||""),[c,d]=(0,r.useState)(a[0]||""),[u,p]=(0,r.useState)(),[h,w]=(0,r.useState)(),[k,A]=(0,r.useState)(),x=u||e.error;return r.createElement(f.A,{className:t.importFormContainer},x?r.createElement(l.ErrorMessage,{error:x}):null,r.createElement(y.Ay,{container:!0,spacing:1,justifyContent:"center",alignItems:"center",className:t.assemblySelector},r.createElement(y.Ay,{item:!0},r.createElement(g.A,{style:{padding:12}},r.createElement(E.A,{style:{textAlign:"center"}},"Select assemblies for dotplot view"),r.createElement(y.Ay,{container:!0,spacing:1,justifyContent:"center",alignItems:"center"},r.createElement(y.Ay,{item:!0},r.createElement(l.AssemblySelector,{selected:c,onChange:e=>d(e),session:n})),r.createElement(y.Ay,{item:!0},r.createElement(l.AssemblySelector,{selected:s,onChange:e=>i(e),session:n})),r.createElement(y.Ay,{item:!0},r.createElement(m.A,null,r.createElement(b.A,{onClick:function(){try{if(!(0,v.isSessionWithAddTracks)(n))return;p(void 0),e.setError(void 0),(0,o.transaction)((()=>{h?(n.addTrackConf(h),e.toggleTrack(h.trackId)):k&&e.showTrack(k),e.setViews([{bpPerPx:.1,offsetPx:0},{bpPerPx:.1,offsetPx:0}]),e.setAssemblyNames(s,c)}))}catch(e){console.error(e),p(e)}},variant:"contained",color:"primary"},"Launch"))))),r.createElement(N,{setShowTrackId:A,assembly2:s,assembly1:c,setSessionTrackData:w,sessionTrackData:h,model:e}))))}));var z=n(9937);const T=(0,r.lazy)((()=>Promise.all([n.e(8565),n.e(7110),n.e(4727)]).then(n.bind(n,75083)))),F=(0,a.observer)((function({model:e}){const t=e.tracks.filter((e=>e.displays[0].warnings?.length)),[n,l]=(0,r.useState)(!1);return t.length?r.createElement(z.A,{severity:"warning"},"Warnings during render"," ",r.createElement(b.A,{onClick:()=>l(!0)},"More info"),n?r.createElement(T,{trackWarnings:t,handleClose:()=>l(!1)}):null):null}));var O=n(61723),I=n(64065),R=n(6304),j=n(6313),$=n(87440),D=n(50253),H=n(95936);const W=(0,s.n9)()({dpad:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",margin:0,position:"absolute",right:50,zIndex:1e3,top:50},icon:{padding:0,margin:0}}),V=(0,a.observer)((function({model:e}){const{classes:t}=W();return r.createElement(g.A,{className:t.dpad,elevation:6},r.createElement("div",null),r.createElement(O.A,{className:t.icon,onClick:()=>e.vview.scroll(100)},r.createElement(R.A,null)),r.createElement("div",null),r.createElement(O.A,{className:t.icon,onClick:()=>e.hview.scroll(-100)},r.createElement(j.A,null)),r.createElement("div",null),r.createElement(O.A,{className:t.icon,onClick:()=>e.hview.scroll(100)},r.createElement($.A,null)),r.createElement("div",null),r.createElement(O.A,{className:t.icon,onClick:()=>e.vview.scroll(-100)},r.createElement(I.A,null)),r.createElement("div",null),r.createElement(O.A,{className:t.icon,onClick:()=>{e.hview.zoomIn(),e.vview.zoomIn()}},r.createElement(D.A,null)),r.createElement("div",null),r.createElement(O.A,{className:t.icon,onClick:()=>{e.hview.zoomOut(),e.vview.zoomOut()}},r.createElement(H.A,null)))}));var J=n(23758),q=n(64359),X=n(2859);function Y(e){return r.createElement(X.A,e,r.createElement("path",{fill:"currentColor",d:"M13,6V11H18V7.75L22.25,12L18,16.25V13H13V18H16.25L12,22.25L7.75,18H11V13H6V16.25L1.75,12L6,7.75V11H11V6H7.75L12,1.75L16.25,6H13Z"}))}function K(e){return r.createElement(X.A,e,r.createElement("path",{fill:"currentColor",d:"M10.07,14.27C10.57,14.03 11.16,14.25 11.4,14.75L13.7,19.74L15.5,18.89L13.19,13.91C12.95,13.41 13.17,12.81 13.67,12.58L13.95,12.5L16.25,12.05L8,5.12V15.9L9.82,14.43L10.07,14.27M13.64,21.97C13.14,22.21 12.54,22 12.31,21.5L10.13,16.76L7.62,18.78C7.45,18.92 7.24,19 7,19A1,1 0 0,1 6,18V3A1,1 0 0,1 7,2C7.24,2 7.47,2.09 7.64,2.23L7.65,2.22L19.14,11.86C19.57,12.22 19.62,12.85 19.27,13.27C19.12,13.45 18.91,13.57 18.7,13.61L15.54,14.23L17.74,18.96C18,19.46 17.76,20.05 17.26,20.28L13.64,21.97Z"}))}const Z=(0,a.observer)((function({model:e}){return r.createElement("div",null,r.createElement(O.A,{onClick:e.zoomOutButton},r.createElement(H.A,null)),r.createElement(O.A,{onClick:e.zoomInButton},r.createElement(D.A,null)),r.createElement(O.A,{onClick:()=>e.activateTrackSelector(),title:"Open track selector"},r.createElement(P.xU,null)),r.createElement(J.A,{menuItems:[{onClick:()=>e.squareView(),label:"Square view - same base pairs per pixel"},{onClick:()=>e.squareViewProportional(),label:"Rectanglularize view - same total bp"},{onClick:()=>e.showAllRegions(),label:"Show all regions"},{onClick:()=>e.setDrawCigar(!e.drawCigar),type:"checkbox",label:"Draw CIGAR",checked:e.drawCigar},{onClick:()=>e.setShowPanButtons(!e.showPanButtons),label:"Show pan buttons",type:"checkbox",checked:e.showPanButtons},{label:"Click and drag mode",subMenu:[{onClick:()=>e.setCursorMode("move"),label:"Pan by default, select region when ctrl/cmd key is held",icon:Y,type:"radio",checked:"move"===e.cursorMode},{onClick:()=>e.setCursorMode("crosshair"),label:"Select region by default, pan when ctrl/cmd key is held",icon:K,type:"radio",checked:"crosshair"===e.cursorMode}]},{label:"Wheel scroll mode",subMenu:[{onClick:()=>e.setWheelMode("pan"),label:"Pans view",type:"radio",checked:"pan"===e.wheelMode},{onClick:()=>e.setWheelMode("zoom"),label:"Zooms view",type:"radio",checked:"zoom"===e.wheelMode},{onClick:()=>e.setWheelMode("none"),label:"Disable",type:"radio",checked:"none"===e.wheelMode}]}]},r.createElement(q.A,null)))})),_=(0,s.n9)()({bp:{display:"flex",alignItems:"center",marginLeft:10},spacer:{flexGrow:1},headerBar:{display:"flex",position:"relative"}}),U=(0,a.observer)((function({model:e,selection:t}){const{classes:n}=_(),{hview:l,vview:a,showPanButtons:o}=e;return r.createElement("div",{className:n.headerBar},r.createElement(Z,{model:e}),r.createElement(E.A,{className:n.bp,variant:"body2",color:"textSecondary"},"x: ",l.assemblyNames.join(",")," ",(0,v.getBpDisplayStr)(l.currBp),r.createElement("br",null),"y: ",a.assemblyNames.join(",")," ",(0,v.getBpDisplayStr)(a.currBp)),t?r.createElement(E.A,{className:n.bp,variant:"body2",color:"textSecondary"},`width:${(0,v.getBpDisplayStr)(l.bpPerPx*t.width)}`," ",r.createElement("br",null),`height:${(0,v.getBpDisplayStr)(a.bpPerPx*t.height)}`):null,r.createElement("div",{className:n.spacer}),r.createElement(F,{model:e}),o?r.createElement(V,{model:e}):null)}));var G=n(86495),Q=n(91392),ee=n(90257),te=n(18283),ne=n(48231),re=n(57833),le=n(77089);function ae(){return ae=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ae.apply(null,arguments)}const oe=(0,s.n9)()((e=>({tooltip:{position:"absolute",pointerEvents:"none",backgroundColor:(0,te.X4)(e.palette.grey[700],.9),borderRadius:e.shape.borderRadius,color:e.palette.common.white,fontFamily:e.typography.fontFamily,padding:"4px 8px",fontSize:e.typography.pxToRem(12),lineHeight:(1.4,Math.round(14e4)/1e5+"em"),maxWidth:300,wordWrap:"break-word"}}))),se=(0,a.observer)((function({model:e,mouserect:t,mouserectClient:n,xdistance:l}){const{classes:a}=oe(),{hview:o,vview:s,viewHeight:i}=e,c=(0,ne.A)(),{refs:m,floatingStyles:d,context:u}=(0,le.we)({placement:l<0?"left":"right",strategy:"fixed"}),p=(0,le.ju)(u,n?{x:n[0],y:n[1]}:void 0),{getFloatingProps:h}=(0,le.bv)([p]),f=c?.components?.MuiPopper;return t?r.createElement(re.Z,{container:f?.defaultProps?.container},r.createElement("div",ae({className:a.tooltip,ref:m.setFloating,style:{...d,zIndex:1e5,pointerEvents:"none"}},h()),`x - ${(0,ee.wJ)(t[0],o)}`,r.createElement("br",null),`y - ${(0,ee.wJ)(i-t[1],s)}`,r.createElement("br",null))):null})),ie=(0,a.observer)((function({model:e,mousedown:t,mousedownClient:n,xdistance:l,ydistance:a}){const{classes:o}=oe(),{hview:s,vview:i,viewHeight:c}=e,m=(0,ne.A)(),d=(n?.[0]||0)-0,u=(n?.[1]||0)-0,{refs:p,floatingStyles:h,context:f}=(0,le.we)({placement:l<0?"right":"left"}),y=(0,le.ju)(f,{x:d,y:u}),{getFloatingProps:g}=(0,le.bv)([y]),E=m?.components?.MuiPopper;return t&&Math.abs(l)>3&&Math.abs(a)>3?r.createElement(re.Z,{container:E?.defaultProps?.container},r.createElement("div",ae({className:o.tooltip,ref:p.setFloating,style:{...h,zIndex:1e5,pointerEvents:"none"}},g()),`x - ${(0,ee.wJ)(t[0],s)}`,r.createElement("br",null),`y - ${(0,ee.wJ)(c-t[1],i)}`,r.createElement("br",null))):null})),ce={left:0,top:0,width:0,height:0},me=(0,s.n9)()((e=>({spacer:{gridColumn:"1/2",gridRow:"2/2"},root:{position:"relative",marginBottom:e.spacing(1),overflow:"hidden"},container:{display:"grid",padding:5,position:"relative"},overlay:{pointerEvents:"none",overflow:"hidden",display:"flex",width:"100%",gridRow:"1/2",gridColumn:"2/2",zIndex:100,"& path":{cursor:"crosshair",fill:"none"}},content:{position:"relative",gridColumn:"2/2",gridRow:"1/2"},resizeHandle:{height:4,background:"#ccc",boxSizing:"border-box",borderTop:"1px solid #fafafa"}})));function de(e,t){return e&&[e[0]-t.left,e[1]-t.top]}const ue=(0,a.observer)((({model:e})=>{const{classes:t}=me();return r.createElement("div",{className:t.overlay},e.tracks.map((e=>{const[t]=e.displays,{RenderingComponent:n}=t;return n?r.createElement(n,{key:e.configuration.trackId,model:t}):null})))})),pe=(0,a.observer)((function({model:e}){const{classes:t}=me(),[n,a]=(0,r.useState)(),[s,i]=(0,r.useState)(),[m,d]=(0,r.useState)(!1),[u,p]=(0,r.useState)(),h=(0,r.useRef)(null),f=(0,r.useRef)(null),y=(0,r.useRef)(0),g=(0,r.useRef)(0),E=(0,r.useRef)(!1),[b,v]=(0,r.useState)(!1),[w,k]=(0,r.useState)(!1),A=h.current?.getBoundingClientRect()||ce,x=h.current?.getBoundingClientRect()||ce,S=de(s,A),C=de(n,A),P=de(u,A),M=P||C,L=u||n,N=S&&M?M[0]-S[0]:0,B=S&&M?M[1]-S[1]:0,{hview:z,vview:T,wheelMode:F,cursorMode:O}=e,I="move"===O&&!b||"crosshair"===O&&b,R="move"===O&&b||"crosshair"===O&&!b;return(0,r.useEffect)((()=>{function e(e){const t=c()(e);e.preventDefault(),y.current+=t.pixelX,g.current-=t.pixelY,E.current||(E.current=!0,window.requestAnimationFrame((()=>{(0,o.transaction)((()=>{if("pan"===F)z.scroll(y.current/3),T.scroll(g.current/10);else if("zoom"===F&&Math.abs(g.current)>2*Math.abs(y.current)&&C){const e=g.current<0?1.1:.9;z.zoomTo(z.bpPerPx*e,C[0]),T.zoomTo(T.bpPerPx*e,x.height-C[1])}})),E.current=!1,y.current=0,g.current=0})))}if(h.current){const t=h.current;return t.addEventListener("wheel",e),()=>t.removeEventListener("wheel",e)}return()=>{}}),[z,T,F,C,x.height]),(0,r.useEffect)((()=>{function e(e){a([e.clientX,e.clientY]),n&&s&&I&&!u&&(z.scroll(-e.clientX+n[0]),T.scroll(e.clientY-n[1]))}return window.addEventListener("mousemove",e),()=>window.removeEventListener("mousemove",e)}),[I,n,s,O,b,u,z,T]),(0,r.useEffect)((()=>{function e(e){(e.metaKey||e.ctrlKey)&&k(!0)}function t(e){e.metaKey||e.ctrlKey||k(!1)}return window.addEventListener("keydown",e),window.addEventListener("keyup",t),()=>{window.removeEventListener("keydown",e),window.addEventListener("keyup",t)}}),[]),(0,r.useEffect)((()=>{function e(e){Math.abs(N)>3&&Math.abs(B)>3&&R?p([e.clientX,e.clientY]):i(void 0)}return S&&!P?(window.addEventListener("mouseup",e,!0),()=>{window.removeEventListener("mouseup",e,!0)}):()=>{}}),[R,S,C,P,N,B,b,O]),r.createElement("div",null,r.createElement(U,{model:e,selection:R&&S&&M?{width:Math.abs(N),height:Math.abs(B)}:void 0}),r.createElement("div",{ref:f,className:t.root,onMouseLeave:()=>d(!1),onMouseEnter:()=>d(!0)},r.createElement("div",{className:t.container},r.createElement(Q.en,{model:e}),r.createElement(Q.KM,{model:e}),r.createElement("div",{ref:h,className:t.content},m&&R?r.createElement(se,{model:e,mouserect:M,mouserectClient:L,xdistance:N}):null,R?r.createElement(ie,{model:e,mousedown:S,mousedownClient:s,xdistance:N,ydistance:B}):null,r.createElement("div",{style:{cursor:w?"pointer":O},onMouseDown:e=>{if(0===e.button){const{clientX:t,clientY:n}=e;i([t,n]),a([t,n]),v(w)}}},r.createElement(G.A,{model:e},R&&S&&M?r.createElement("rect",{fill:"rgba(255,0,0,0.3)",x:Math.min(M[0],S[0]),y:Math.min(M[1],S[1]),width:Math.abs(N),height:Math.abs(B)}):null)),r.createElement("div",{className:t.spacer})),r.createElement(ue,{model:e}),r.createElement(l.Menu,{open:Boolean(P),onMenuItemClick:(e,t)=>{t(),p(void 0),i(void 0)},onClose:()=>{p(void 0),i(void 0)},anchorReference:"anchorPosition",anchorPosition:u?{top:u[1]+50,left:u[0]+50}:void 0,style:{zIndex:1e4},menuItems:[{label:"Zoom in",onClick:()=>{S&&P&&e.zoomIn(S,P),d(!1)}},{label:"Open linear synteny view",onClick:()=>{S&&P&&e.onDotplotView(S,P),d(!1)}}]})),r.createElement(l.ResizeHandle,{onDrag:t=>e.setHeight(e.height+t),className:t.resizeHandle})))})),he=(0,a.observer)((({model:e})=>{const{initialized:t,loading:n,error:a}=e;return!t&&!n||a?r.createElement(B,{model:e}):n?r.createElement(l.LoadingEllipses,{variant:"h6"}):r.createElement(pe,{model:e})}))},86495:(e,t,n)=>{n.d(t,{A:()=>c,z:()=>i});var r=n(7552),l=n(68446),a=n(48231),o=n(99546);function s(){return s=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},s.apply(null,arguments)}const i=(0,l.observer)((function({model:e,children:t}){const{viewWidth:n,viewHeight:l,hview:i,vview:c}=e,m=i.dynamicBlocks.contentBlocks,d=c.dynamicBlocks.contentBlocks;if(!m.length||!d.length)return null;const u=i.displayedRegionsTotalPx-i.offsetPx,p=c.displayedRegionsTotalPx-c.offsetPx,h=m[0].offsetPx-i.offsetPx,f=d[0].offsetPx-c.offsetPx,y=(0,a.A)(),g=y.palette.divider,E=Math.max(h,0),b=Math.max(l-p,0),v=Math.min(u-h,n),w=Math.min(l-f-b,l);let k=1/0,A=1/0;return r.createElement(r.Fragment,null,r.createElement("rect",s({x:E,y:b,width:v,height:w},(0,o.getFillProps)(y.palette.background.default))),r.createElement("g",null,m.map((e=>{const t=e.offsetPx-i.offsetPx,n=Math.floor(t)!==Math.floor(k);return n&&(k=t),n?r.createElement("line",s({key:JSON.stringify(e),x1:t,y1:0,x2:t,y2:l},(0,o.getStrokeProps)(g))):null})),d.map((e=>{const t=l-(e.offsetPx-c.offsetPx),a=Math.floor(t)!==Math.floor(A);return a&&(A=t),a?r.createElement("line",s({key:JSON.stringify(e),x1:0,y1:t,x2:n,y2:t},(0,o.getStrokeProps)(g))):null})),r.createElement("line",s({x1:u,y1:0,x2:u,y2:l},(0,o.getStrokeProps)(g))),r.createElement("line",s({x1:0,y1:l-p,x2:n,y2:l-p},(0,o.getStrokeProps)(g)))),t)}));function c({model:e,children:t}){const{viewWidth:n,viewHeight:l}=e;return r.createElement("svg",{width:n,height:l,style:{background:"rgba(0,0,0,0.12)"}},r.createElement(i,{model:e},t))}}}]);
//# sourceMappingURL=4752.71ebb27c.chunk.js.map